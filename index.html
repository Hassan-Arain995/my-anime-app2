<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Anime Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: #fff;
}
header {
    background: #020617;
    padding: 15px;
    text-align: center;
    font-size: 20px;
    font-weight: bold;
}
.container {
    padding: 15px;
}
input, button {
    width: 100%;
    padding: 10px;
    margin: 5px 0;
    border-radius: 6px;
    border: none;
}
button {
    background: #22c55e;
    color: #000;
    font-weight: bold;
    cursor: pointer;
}
.card {
    background: #020617;
    padding: 12px;
    margin-top: 10px;
    border-radius: 8px;
}
.card span {
    display: block;
    margin: 5px 0;
}
.small-btn {
    background: #38bdf8;
    margin-top: 5px;
}
</style>
</head>

<body>

<header>Anime Tracker</header>

<div class="container">

<input id="animeName" placeholder="Anime Name">
<input id="totalEp" type="number" placeholder="Total Episodes">
<button onclick="addAnime()">Add Anime</button>

<div id="list"></div>

</div>

<script>
/* ===============================
   STORAGE & ACCOUNT SYNC
   =============================== */

let animeList = JSON.parse(localStorage.getItem("animeList")) || [];

// Optional Firebase (REMOVE if not needed)
const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_DOMAIN",
    projectId: "YOUR_PROJECT_ID"
};
// Firebase not initialized unless user adds SDK

function saveData() {
    localStorage.setItem("animeList", JSON.stringify(animeList));
}

/* ===============================
   NOTIFICATION SUPPORT
   =============================== */

if ("Notification" in window) {
    Notification.requestPermission();
}

function sendNotification(title, body) {
    if (Notification.permission === "granted") {
        new Notification(title, { body });
    }
}

/* ===============================
   ANIME FUNCTIONS
   =============================== */

function addAnime() {
    const name = animeName.value.trim();
    const total = Number(totalEp.value);

    if (!name || !total) return;

    animeList.push({
        name,
        total,
        watched: 0
    });

    saveData();
    render();
    animeName.value = "";
    totalEp.value = "";
}

function watchEp(index) {
    let anime = animeList[index];
    if (anime.watched < anime.total) {
        anime.watched++;
        saveData();

        if (anime.watched === anime.total) {
            sendNotification(
                "Anime Completed ðŸŽ‰",
                `${anime.name} is fully watched`
            );
        }
    }
    render();
}

function render() {
    list.innerHTML = "";
    animeList.forEach((a, i) => {
        list.innerHTML += `
        <div class="card">
            <span><b>${a.name}</b></span>
            <span>Episodes: ${a.watched} / ${a.total}</span>
            <button class="small-btn" onclick="watchEp(${i})">+1 Episode</button>
        </div>
        `;
    });
}

render();

/* ===============================
   BACKGROUND AUTO TRACK
   =============================== */

setInterval(() => {
    animeList.forEach(a => {
        if (a.watched === a.total && !a.notified) {
            a.notified = true;
            sendNotification("Reminder", `${a.name} completed`);
        }
    });
}, 60000);

</script>

</body>
</html>
